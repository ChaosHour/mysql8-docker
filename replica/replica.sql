-- CREATE DATABASE test

-- set server id

-- SET GLOBAL server_id = 300;

-- select sleep(3);

-- CREATE USER IF NOT EXISTS for repl@%:
CREATE USER IF NOT EXISTS `repl`@`%` IDENTIFIED WITH 'caching_sha2_password' AS 0x244124303035244A5722792975707B0B3A5C380B3C7D470E5E44086743514A515A316F787046627A344B697A70713361425650757474626A6658446D58736542536D66446243 REQUIRE NONE PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK PASSWORD HISTORY DEFAULT PASSWORD REUSE INTERVAL DEFAULT PASSWORD REQUIRE CURRENT DEFAULT;
GRANT USAGE ON *.* TO `repl`@`%`;
GRANT REPLICATION SLAVE ON *.* TO `repl`@`%`;


-- ALTER USER `repl`@`%` IDENTIFIED WITH caching_sha2_password BY 'xxx';

-- ALTER USER `repl`@`%`  IDENTIFIED WITH 'caching_sha2_password' AS 0x244124303035244A5722792975707B0B3A5C380B3C7D470E5E44086743514A515A316F787046627A344B697A70713361425650757474626A6658446D58736542536D66446243 REQUIRE NONE PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK PASSWORD HISTORY DEFAULT PASSWORD REUSE INTERVAL DEFAULT PASSWORD REQUIRE CURRENT DEFAULT;

-- select sleep(3);

-- set server id

SET GLOBAL server_id = 2;

select sleep(3);

STOP REPLICA;

CHANGE REPLICATION SOURCE TO
  SOURCE_HOST='172.20.0.3',
  SOURCE_USER='repl',
  SOURCE_PASSWORD='slAv3',
  SOURCE_PORT=3306,
  GET_MASTER_PUBLIC_KEY=1,
  SOURCE_AUTO_POSITION = 1 FOR CHANNEL 'source_3'; 

START REPLICA FOR CHANNEL 'source_3';